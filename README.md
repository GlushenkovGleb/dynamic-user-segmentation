# dynamic-user-segmentation
Сервис, хранящий пользователя и сегменты, в которых он состоит (создание, изменение, удаление сегментов, а также добавление и удаление пользователей в сегмент).

## Оглавление

1. [Запуск сервиса](#Запуск-сервиса)
2. [Примеры запросов](#Примеры-запросов)
3. [Архитектура](#Архитектура)
4. [Функциональные требования](#Функциональные-требования)
5. [Трудности в дополнительных заданиях](#Трудности-в-дополнительных-заданиях)
                                                                                                

## Запуск сервиса

## Примеры запросов

## Архитектура
### Архитектура сервиса
![Alt-текст](./docs/архитектура.jpg "Орк")
### Структура БД
![Alt-текст](./docs/структура-бд.png "Орк")

## Функциональные требования
#### 1. Создание сегмента - POST /api/public/v1/segments
Тело запроса:

|   | Название   | Формат | Кратность | Описание                                                   |
|---|------------|--------|-----------|------------------------------------------------------------|
| 1 | slug       | string | 1         | уникальное название нового сегмента                        |
| 2 | percentage | float  | 0-1       | процент пользователей, которому определится данный сегмент |
| 3 | is_auto    | bool   | 0-1       | флаг автоматической сегментации                            |

#### 2. Удаление сегмента - DELETE /api/public/v1/segment/{slug}
Параметры пути:

|   | Название | Формат | Кратность | Описание                                |
|---|----------|--------|-----------|-----------------------------------------|
| 1 | segment  | string | 1         | уникальное название удаляемого сегмента |

#### 3. Добавление пользователя в сегменты - PUT /api/public/v1/users/{user_id}/segments
Тело запроса:

|   | Название         | Формат            | Кратность | Описание                                                       |
|---|------------------|-------------------|-----------|----------------------------------------------------------------|
| 1 | slugs_to_delete  | List[string]      | 0-1       | список уникальных названий сегментов для удаления пользователю |
| 2 | segments_to_add  | List[slug_to_add] | 0-1       | список сегментов для добавления у пользователя                 |
| - | segment_to_add   | Object            | -         | сегмент для добавления                                         |
| - | -.slug           | string            | 0-1       | уникальное название сегмента для добавления пользователю       |
| - | -.ttl_in_seconds | int               | 0-1       | время действия сегмента у пользователя                         |

Параметры пути:

|   | Название | Формат | Кратность | Описание                              |
|---|----------|--------|-----------|---------------------------------------|
| 1 | user_id  | string | 1         | уникальный идентификатор пользователя |

#### 4. Получение активных сегментов пользователя - GET /api/public/v1/users/{user_id}/segments
Параметры пути:

|   | Название | Формат | Кратность | Описание                              |
|---|----------|--------|-----------|---------------------------------------|
| 1 | user_id  | string | 1         | уникальный идентификатор пользователя |

#### 5. Получение истории сегментов пользователя - GET /api/public/v1/users/segments/history

Параметры пути:

|   | Название | Формат | Кратность | Описание                              |
|---|----------|--------|-----------|---------------------------------------|
| 1 | user_id  | string | 1         | уникальный идентификатор пользователя |

Параметры запроса:

|   | Название | Формат | Кратность | Описание                                                          |
|---|----------|--------|-----------|-------------------------------------------------------------------|
| 1 | begin    | string | 1         | начало периода по паттерну: "{год}-{месяц}" (год и месяц - числа) |
| 2 | end      | string | 1         | конец периода по паттерну: "{год}-{месяц}" (год и месяц - числа)  | 

## Трудности в дополнительных заданиях
